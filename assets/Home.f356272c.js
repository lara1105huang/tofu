import{d as Q,r,a as G,c as K,o as X,b as p,e,F as E,f as y,w as Z,v as J,g as a,h as c,i as m,j as f,t as _,k as A,l as V,u as B}from"./index.0dd71782.js";import{h as $,f as x,a as j}from"./firebaseConfig.10f39527.js";const I={class:"tofu-area"},ee=e("div",{class:"title"},"\u81ED\u51B0\u5E97\u83DC\u55AE",-1),ue=e("div",{class:"text-centent mt-5"},"\u5927\u91CC\u5340\u5927\u5CF0\u8DEF530-1\u865F",-1),le=e("div",{class:"text-centent"},"\u806F\u7D61\u96FB\u8A71: 0919 271 644",-1),oe={class:"menu"},se=["onClick"],ae=e("span",null,"\u5143",-1),te=e("i",{class:"fa-solid fa-circle-plus"},null,-1),ne=e("h4",null,"\u8CFC\u7269\u8ECA",-1),re={class:"menu_shop"},de={class:"cart-item"},ie={class:"cart-title"},ce={class:"price"},_e={class:"count"},ve={class:"count"},pe={class:"handler"},me=["onClick"],fe=e("i",{class:"fa-solid fa-circle-plus"},null,-1),he=[fe],Ae=["onClick"],Fe=e("i",{class:"fa-solid fa-circle-minus ml-2"},null,-1),Ce=[Fe],ge=["onClick"],De=e("i",{class:"fa-solid fa-trash"},null,-1),be=[De],ke=["onClick"],Ee={class:"countAllTotal"},ye={class:"form-area"},Ve=e("span",null,null,-1),Be=e("span",null,"\u60A8\u597D\uFF1A",-1),xe=e("span",null,"\u5148\u751F/\u5C0F\u59D0",-1),we=e("span",null,"\u8A02\u55AE\u865F\u78BC\uFF1A",-1),Te=e("span",null,null,-1),Ue=e("div",null,"\u8ACB\u60A8\u5728\u7576\u65E5\u8A02\u8CFC\u6642\u9593\u5167\u5B8C\u6210\u60A8\u7684\u8A02\u55AE\u4EA4\u6613\uFF01",-1),$e=e("span",null,"\u7E3D\u50F9\uFF1A",-1),Oe={class:"dialog-footer"},Ne=Q({__name:"Home",setup(Ye){const w=r(),s=r([]);r();const b=$(new Date).format("YYYY-MM-DD-HHmm");r(0);const n=r({name:"",phone:"",add:""}),O=G({name:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684\u59D3\u540D",trigger:"blur"}],phone:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684\u884C\u52D5\u96FB\u8A71",trigger:"blur"}],add:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684\u5730\u5740",trigger:"blur"}],type:[{type:"array",required:!0,message:"\u8ACB\u8F38\u5165",trigger:"change"}]});var Y=x.database().ref("orders/");const M=r({}),H=()=>{Y.once("value",o=>{M.value=o.val()})};r({id:"",productName:"",price:"",count:"",total:""});const F=r(!1),N=()=>{F.value=!0},k=r(),S=async(o,u)=>{if(!!u){var d=x.database().ref("user/"),t=x.database().ref("orders/");console.log(C.value," countAllTotal"),await u.validate((i,h)=>{i?(k.value=n.value,d.push({orderUser:n.value}),t.push({orderNo:b,orderUser:n.value,time:$(new Date).format("YYYY-MM-DD HH:mm"),countTotal:C.value,list:s.value}),N(b,k.value,C.value)):console.log("\u932F\u8AA4\u9001\u51FA\uFF01",h)})}},D=r(),q=async()=>{console.log({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0}.VITE_GRAPHQL_SHEETID);const d="https://sheets.googleapis.com/v4/spreadsheets/19YWnM9PrXXEUOcT9zWkQYpiZ1W3o6i-UToEGsUPcFcU/values/\u5546\u54C1\u5217\u8868?alt=json&key=AIzaSyAieT4Folrx3Tsx-iZqzu_HyNBt349BMaw";await j.get(d).then(t=>{D.value=t.data.values,console.log(t.data);for(var i=0;i<=D.value.length;i++)for(var h=D.value[0],g=0;g<=h.length;g++)h[g]})},T=r(!1),R=o=>{var u=[];u[0]=o[0],u[1]=o[1],u[2]=o[2];var d=1;for(var t in s.value)if(s.value[t][1]===o[1]){d=s.value[t][3]+1;var i=s.value.indexOf(s.value[t]);s.value.splice(i,1)}u[3]=d,u[4]=u[2]*d,s.value.push(u),console.log(s.value.length),s.value.length>0&&(T.value=!0)},L=o=>{o[3]++};r([]);const P=o=>{console.log("removeOne",o),o[3]--,o[3]<=0&&s.value.splice(o,1)},W=o=>{s.value.splice(o,1)},C=K(()=>{var o=0;for(var u in s.value)o+=s.value[u][3]*s.value[u][2];return o});return X(()=>{q(),H()}),(o,u)=>{const d=m("el-input"),t=m("el-form-item"),i=m("el-checkbox"),h=m("el-checkbox-group"),g=m("el-form"),U=m("el-button"),z=m("el-dialog");return f(),p("div",I,[ee,ue,le,e("ul",oe,[(f(!0),p(E,null,y(D.value,l=>(f(),p("li",{key:l},[e("a",{onClick:v=>R(l)},[(f(!0),p(E,null,y(l,v=>(f(),p("div",{key:v},[e("span",null,_(v),1)]))),128)),ae,te],8,se)]))),128))]),ne,Z(e("div",re,[a(g,{ref_key:"ruleFormRef",ref:w,model:n.value,rules:O,"status-icon":""},{default:c(()=>[(f(!0),p(E,null,y(s.value,l=>(f(),p("div",{class:"cart",key:l},[e("div",de,[e("div",ie,_(l[1]),1),e("div",null,[e("span",ce,_("$"+l[2]),1),A(" x "),e("span",_e,_(l[3]),1),e("span",ve,_("$"+l[2]*l[3]),1)]),e("div",pe,[e("a",{href:"#",class:"cart-btn plus",onClick:V(v=>L(l),["prevent"])},he,8,me),e("a",{href:"#",class:"cart-btn minus",onClick:V(v=>P(l),["prevent"])},Ce,8,Ae),e("a",{href:"#",class:"cart-btn minus",onClick:V(v=>W(l),["prevent"])},be,8,ge)])]),e("a",{class:"btn",onClick:v=>S(l,w.value)},"\u9001\u51FA\u8CFC\u7269\u8ECA",8,ke)]))),128)),e("p",Ee,[A("\u7E3D\u8A08\uFF1A "),e("span",null,_("$"+B(C)),1)]),e("div",ye,[a(t,{label:"\u59D3\u540D",prop:"name"},{default:c(()=>[a(d,{modelValue:n.value.name,"onUpdate:modelValue":u[0]||(u[0]=l=>n.value.name=l)},null,8,["modelValue"])]),_:1}),a(t,{label:"\u96FB\u8A71",prop:"phone"},{default:c(()=>[a(d,{modelValue:n.value.phone,"onUpdate:modelValue":u[1]||(u[1]=l=>n.value.phone=l)},null,8,["modelValue"])]),_:1}),a(t,{label:"\u5730\u5740",prop:"add"},{default:c(()=>[a(d,{modelValue:n.value.add,"onUpdate:modelValue":u[2]||(u[2]=l=>n.value.add=l)},null,8,["modelValue"])]),_:1}),a(t,{label:"\u4F7F\u7528\u65B9\u5F0F:",prop:"type"},{default:c(()=>[a(h,{modelValue:n.value.type,"onUpdate:modelValue":u[3]||(u[3]=l=>n.value.type=l)},{default:c(()=>[a(i,{label:"\u5167\u7528",name:"\u5167\u7528"}),a(i,{label:"\u5916\u5E36\u81EA\u53D6",name:"\u5916\u5E36\u81EA\u53D6"}),a(i,{label:"\u5916\u9001",name:"\u5916\u9001"})]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["model","rules"])],512),[[J,T.value]]),a(z,{modelValue:F.value,"onUpdate:modelValue":u[6]||(u[6]=l=>F.value=l),title:"Warning",width:"30%",center:""},{footer:c(()=>[e("div",null,[e("div",null,[Be,A(_(k.value.name),1),xe]),e("div",null,[we,A(_(B(b)),1),Te]),Ue,$e,e("span",null,_(B(C)),1)]),e("span",Oe,[a(U,{onClick:u[4]||(u[4]=l=>F.value=!1)},{default:c(()=>[A("\u95DC\u9589\u8996\u7A97")]),_:1}),a(U,{type:"primary",onClick:u[5]||(u[5]=l=>F.value=!1)},{default:c(()=>[A(" \u8A02\u55AE\u5B8C\u6210 ")]),_:1})])]),default:c(()=>[Ve]),_:1},8,["modelValue"])])}}});export{Ne as default};
