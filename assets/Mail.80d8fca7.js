import{d as Q,r as d,a as K,c as L,o as R,b as v,e,F as B,f as E,g as s,w as c,k,h as m,i as f,t as _,j as F,u as V}from"./index.77e3c52f.js";import{h as T,f as x,a as X,e as Z}from"./index.4f1ad240.js";const G={class:"tofu-area"},J=e("div",{class:"title"},"\u81ED\u51B0\u5E97\u83DC\u55AE",-1),I=e("div",{class:"text-centent mt-5"},"\u5927\u91CC\u5340\u5927\u5CF0\u8DEF530-1\u865F",-1),ee=e("div",{class:"text-centent"},"\u806F\u7D61\u96FB\u8A71: 0919 271 644",-1),ue={class:"menu"},le=["onClick"],oe=e("span",null,"\u5143",-1),se=e("i",{class:"fa-solid fa-circle-plus"},null,-1),ae=e("h4",null,"\u8CFC\u7269\u8ECA",-1),te={class:"menu_shop"},ne={class:"cart-item"},re={class:"cart-title"},de={class:"price"},ie={class:"count"},ce={class:"count"},_e={class:"handler"},pe=["onClick"],ve=e("i",{class:"fa-solid fa-circle-plus"},null,-1),me=[ve],fe=["onClick"],he=e("i",{class:"fa-solid fa-circle-minus ml-2"},null,-1),Fe=[he],Ae=["onClick"],Ce=e("i",{class:"fa-solid fa-trash"},null,-1),ge=[Ce],be=["onClick"],ke={class:"countAllTotal"},De={class:"form-area"},ye=e("span",null,null,-1),Be=e("span",null,"\u60A8\u597D\uFF1A",-1),Ee=e("span",null,"\u5148\u751F/\u5C0F\u59D0",-1),Ve=e("span",null,"\u8A02\u55AE\u865F\u78BC\uFF1A",-1),xe=e("span",null,null,-1),we=e("div",null,"\u8ACB\u60A8\u5728\u7576\u65E5\u8A02\u8CFC\u6642\u9593\u5167\u5B8C\u6210\u60A8\u7684\u8A02\u55AE\u4EA4\u6613\uFF01",-1),Ue=e("span",null,"\u7E3D\u50F9\uFF1A",-1),$e={class:"dialog-footer"},Ne=Q({__name:"Mail",setup(Te){const w=d(),a=d([]);d();const D=T(new Date).format("YYYY-MM-DD-HHmm");d(0);const n=d({name:"",phone:"",add:""}),M=K({name:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684\u59D3\u540D",trigger:"blur"}],phone:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684\u884C\u52D5\u96FB\u8A71",trigger:"blur"}],add:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684\u5730\u5740",trigger:"blur"}],type:[{type:"array",required:!0,message:"\u8ACB\u8F38\u5165",trigger:"change"}]});var Y=x.database().ref("orders/");const N=d({}),O=()=>{Y.once("value",l=>{N.value=l.val()})};d({id:"",productName:"",price:"",count:"",total:""});const C=d(!1),y=d(),q=async(l,u)=>{if(!!u){var r=x.database().ref("user/"),t=x.database().ref("orders/");console.log(b.value," countAllTotal"),await u.validate((i,h)=>{i?(y.value=n.value,r.push({orderUser:n.value}),t.push({orderNo:D,orderUser:n.value,time:T(new Date).format("YYYY-MM-DD HH:mm"),countTotal:b.value,list:{id:l[0],productName:l[1],price:l[2],count:l[3],total:l[2]*l[3]}}),U()):console.log("\u932F\u8AA4\u9001\u51FA\uFF01",h)})}},U=l=>{const u={name:y.name.value,subject:D};console.log(u),Z.sendForm("service_v77i5ep","template_jqd9wwu",l.target,"aQibbyOFShdl2H3vj",u).then(()=>{console.log(l.target,u)},r=>{alert("\u932F\u8AA4\u6C92\u6709\u50B3\u51FA\u53BB")})},g=d(),H=async()=>{const r="https://sheets.googleapis.com/v4/spreadsheets/19YWnM9PrXXEUOcT9zWkQYpiZ1W3o6i-UToEGsUPcFcU/values/\u5546\u54C1\u5217\u8868?alt=json&key=AIzaSyAieT4Folrx3Tsx-iZqzu_HyNBt349BMaw";await X.get(r).then(t=>{g.value=t.data.values,console.log(t.data);for(var i=0;i<=g.value.length;i++)for(var h=g.value[0],A=0;A<=h.length;A++)h[A]})},S=l=>{var u=[];u[0]=l[0],u[1]=l[1],u[2]=l[2];var r=1;for(var t in a.value)if(a.value[t][1]===l[1]){r=a.value[t][3]+1;var i=a.value.indexOf(a.value[t]);a.value.splice(i,1)}u[3]=r,a.value.push(u)},W=l=>{l[3]++};d([]);const j=l=>{console.log("removeOne",l),l[3]--,l[3]<=0&&a.value.splice(l,1)},z=l=>{a.value.splice(l,1)},b=L(()=>{var l=0;for(var u in a.value)l+=a.value[u][3]*a.value[u][2];return l});return R(()=>{H(),O()}),(l,u)=>{const r=m("el-input"),t=m("el-form-item"),i=m("el-checkbox"),h=m("el-checkbox-group"),A=m("el-form"),$=m("el-button"),P=m("el-dialog");return f(),v("div",G,[J,I,ee,e("ul",ue,[(f(!0),v(B,null,E(g.value,o=>(f(),v("li",{key:o},[e("a",{onClick:p=>S(o)},[(f(!0),v(B,null,E(o,p=>(f(),v("div",{key:p},[e("span",null,_(p),1)]))),128)),oe,se],8,le)]))),128))]),ae,e("div",te,[s(A,{ref_key:"ruleFormRef",ref:w,onSubmit:k(U,["prevent"]),model:n.value,rules:M,"status-icon":""},{default:c(()=>[(f(!0),v(B,null,E(a.value,o=>(f(),v("div",{class:"cart",key:o},[e("div",ne,[e("div",re,_(o[1]),1),e("div",null,[e("span",de,_("$"+o[2]),1),F(" x "),e("span",ie,_(o[3]),1),e("span",ce,_("$"+o[2]*o[3]),1)]),e("div",_e,[e("a",{href:"#",class:"cart-btn plus",onClick:k(p=>W(o),["prevent"])},me,8,pe),e("a",{href:"#",class:"cart-btn minus",onClick:k(p=>j(o),["prevent"])},Fe,8,fe),e("a",{href:"#",class:"cart-btn minus",onClick:k(p=>z(o),["prevent"])},ge,8,Ae)])]),e("input",{type:"submit",onClick:p=>q(o,w.value),value:"\u9001\u51FA\u8CFC\u7269\u8ECA"},null,8,be)]))),128)),e("p",ke,[F("\u7E3D\u8A08\uFF1A "),e("span",null,_("$"+V(b)),1)]),e("div",De,[s(t,{label:"\u59D3\u540D",prop:"name"},{default:c(()=>[s(r,{modelValue:n.value.name,"onUpdate:modelValue":u[0]||(u[0]=o=>n.value.name=o)},null,8,["modelValue"])]),_:1}),s(t,{label:"\u96FB\u8A71",prop:"phone"},{default:c(()=>[s(r,{modelValue:n.value.phone,"onUpdate:modelValue":u[1]||(u[1]=o=>n.value.phone=o)},null,8,["modelValue"])]),_:1}),s(t,{label:"\u5730\u5740",prop:"add"},{default:c(()=>[s(r,{modelValue:n.value.add,"onUpdate:modelValue":u[2]||(u[2]=o=>n.value.add=o)},null,8,["modelValue"])]),_:1}),s(t,{label:"\u4F7F\u7528\u65B9\u5F0F:",prop:"type"},{default:c(()=>[s(h,{modelValue:n.value.type,"onUpdate:modelValue":u[3]||(u[3]=o=>n.value.type=o)},{default:c(()=>[s(i,{label:"\u5167\u7528",name:"\u5167\u7528"}),s(i,{label:"\u5916\u5E36\u81EA\u53D6",name:"\u5916\u5E36\u81EA\u53D6"}),s(i,{label:"\u5916\u9001",name:"\u5916\u9001"})]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["onSubmit","model","rules"])]),s(P,{modelValue:C.value,"onUpdate:modelValue":u[6]||(u[6]=o=>C.value=o),title:"Warning",width:"30%",center:""},{footer:c(()=>[e("div",null,[e("div",null,[Be,F(_(y.value.name),1),Ee]),e("div",null,[Ve,F(_(V(D)),1),xe]),we,Ue,e("span",null,_(V(b)),1)]),e("span",$e,[s($,{onClick:u[4]||(u[4]=o=>C.value=!1)},{default:c(()=>[F("\u95DC\u9589\u8996\u7A97")]),_:1}),s($,{type:"primary",onClick:u[5]||(u[5]=o=>C.value=!1)},{default:c(()=>[F(" \u8A02\u55AE\u5B8C\u6210 ")]),_:1})])]),default:c(()=>[ye]),_:1},8,["modelValue"])])}}});export{Ne as default};
