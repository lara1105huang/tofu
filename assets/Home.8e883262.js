import{d as ae,r as s,a as oe,c as se,o as te,b as f,e,F as E,f as Y,w as $,v as S,g as o,h as i,i as B,j as _,k as F,t as c,l as C,n as ne,u as U,m as re}from"./index.dc664f82.js";import{a as de,e as ie}from"./index.1e2e6164.js";import{h as N}from"./moment.9709ab41.js";import{f as b}from"./firebaseConfig.615b9655.js";const me={class:"tofu-area"},ce={class:"menu"},ve=["onClick"],_e=e("span",null,"\u5143",-1),pe=e("i",{class:"fa-solid fa-circle-plus"},null,-1),fe=e("div",{class:"cart_sun"},[e("h4",null,"\u81EA\u53D6\u8CFC\u7269\u8ECA"),e("p",null,"\u8ACB\u65BC\u8A02\u99101\u5C0F\u6642\u4E4B\u5167\u4F86\u96FB\u9818\u53D6\u8CFC\u7269\u9805\u76EE\uFF0C\u8B1D\u8B1D\u60A8\u7684\u5408\u4F5C\uFF01"),e("p",null,"\u672C\u5E97\u63A1\u73FE\u91D1\u4EA4\u6613\uFF01")],-1),Fe={class:"menu_shop"},Ae=e("div",{class:"order_content_headline"},"\u8A02\u8CFC\u5167\u5BB9\uFF1A",-1),Ce={class:"form-area"},he={class:"cartAll"},De={class:"cart-item"},ge={class:"cart-title"},ye={class:"price"},Be=e("span",{class:"money-icon"},"$",-1),be=e("span",{class:"mount-icon"},"x",-1),Ve={class:"count"},ke={class:"count"},Ee=e("span",{class:"money-icon"},"$",-1),Ye={class:"handler"},Ue=["onClick"],we=["onClick"],xe=["onClick"],Me=["onClick"],Te={class:"countAllTotal"},$e=e("span",{class:"mount-icon"},"$",-1),Se={class:"order_info"},Ne=e("div",{class:"headline"},"\u8A02\u8CFC\u4EBA\u8CC7\u6599\uFF1A",-1),qe={class:"demonstration"},He={class:"el-dialog__body"},Oe=e("div",{class:"m5"},"\u8A02\u55AE\u7DE8\u865F\uFF1A",-1),ze={class:"m5"},Ke=e("div",null,"\u8ACB\u60A8\u5728\u9810\u5B9A\u6642\u9593\u5167\u5B8C\u6210\u8A02\u55AE\u4EA4\u6613\uFF01\u611F\u8B1D\u60A8\u7684\u5408\u4F5C\uFF01",-1),Pe={class:"dialog-footer"},Xe=ae({__name:"Home",setup(Qe){const q=s(""),H=s(""),O=s(""),z=s(""),K=s("");s();const h=s(!1),D=s(),w=s(!1),r=s([]),p=s(N(new Date).format("YYYY-MM-DD-HHmmssSSS")),n=s({name:"",email:"",phone:"",status:"",time:""}),x=s(),P=oe({name:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684\u59D3\u540D",trigger:"blur"}],email:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684email",trigger:"blur"}],phone:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684\u884C\u52D5\u96FB\u8A71",trigger:"blur"},{min:10,max:10,message:"\u4F60\u7684\u884C\u52D5\u96FB\u8A71\u865F\u78BC\u4E0D\u6B63\u78BA\uFF01",trigger:"blur"}],status:[{required:!0,message:"\u8ACB\u9078\u64C7\u4F60\u7684\u98DF\u7528\u65B9\u5F0F\uFF01",trigger:"change"}]});var Q=b.database().ref("orders/");const R=s({}),W=()=>{Q.once("value",a=>{R.value=a.val()})};s({id:"",productName:"",price:"",count:"",total:""}),s();const j=a=>{try{const u={NumberDate:p,form_name:q,form_email:H,form_phone:O,form_time:K,form_status:z,AllTotal:v,orderKey:g};ie.sendForm("service_v77i5ep","template_jqd9wwu",a.target,"aQibbyOFShdl2H3vj",u)}catch(u){console.log({error:u})}};s();const L=()=>{h.value=!0},g=s(),X=async(a,u)=>{if(!!u){var d=b.database().ref("user/"),t=b.database().ref("orders/");b.database().ref("orders/list/"),await u.validate((m,M)=>{m&&(d.push({orderUser:n.value}),t.push({orderNo:p.value,orderUser:n.value,time:N(new Date).format("YYYY-MM-DD HH:mm"),countTotal:v.value,list:r.value}),t.orderByChild("orderNo").equalTo(p.value).once("value",function(V){V.forEach(y=>{g.value=y.key,console.log("orderKey.value",y.key)})}),L(p.value,n.value,v.value))})}},Z=async()=>{const a="https://sheets.googleapis.com/v4/spreadsheets/19YWnM9PrXXEUOcT9zWkQYpiZ1W3o6i-UToEGsUPcFcU/values/\u5546\u54C1\u5217\u8868?alt=json&key=AIzaSyAieT4Folrx3Tsx-iZqzu_HyNBt349BMaw";await de.get(a).then(u=>{D.value=u.data.values;for(var d=0;d<=D.value.length;d++)for(var t=D.value[0],m=0;m<=t.length;m++)t[m]})},G=s(),J=a=>{var u=[];u[0]=a[0],G.value=u[0],u[1]=a[1],u[2]=a[2];var d=1;for(var t in r.value)if(r.value[t][1]===a[1]){d=r.value[t][3]+1;var m=r.value.indexOf(r.value[t]);r.value.splice(m,1)}u[3]=d,r.value.push(u),r.value.length>0&&(w.value=!0)};s();const I=a=>{a[3]++};s([]);const ee=a=>{console.log("\u6E1B\u5C11\u6578\u91CF",a),a[3]--,a[3]<=0&&r.value.splice(a,1)},ue=a=>{r.value.splice(a,1)},v=se(()=>{var a=0;for(var u in r.value)a+=r.value[u][3]*r.value[u][2];return a});return te(()=>{Z(),W()}),(a,u)=>{const d=_("el-input"),t=_("el-form-item"),m=_("el-radio"),M=_("el-radio-group"),V=_("el-date-picker"),y=_("el-form"),T=_("el-button"),le=_("el-dialog");return F(),f("div",me,[e("ul",ce,[(F(!0),f(E,null,Y(D.value,l=>(F(),f("li",{key:l},[e("a",{onClick:A=>J(l)},[(F(!0),f(E,null,Y(l,A=>(F(),f("div",{key:A},[e("span",null,c(A),1)]))),128)),_e,pe],8,ve)]))),128))]),$(e("div",null,[fe,e("div",Fe,[o(y,{ref_key:"ruleFormRef",ref:x,onSubmit:B(j,["prevent"]),model:n.value,rules:P,"status-icon":""},{default:i(()=>[Ae,e("div",Ce,[e("div",he,[(F(!0),f(E,null,Y(r.value,(l,A)=>(F(),f("div",{class:"cart",key:A},[e("div",De,[e("div",ge,c(l[1]),1),e("div",null,[e("span",ye,[Be,C(c(l[2]),1)]),be,e("span",Ve,c(l[3]),1),e("span",ke,[Ee,C(c(l[2]*l[3]),1)])]),e("div",Ye,[e("i",{onClick:B(k=>I(l),["prevent"]),class:"fa-solid fa-circle-plus"},null,8,Ue),e("i",{onClick:B(k=>ee(l),["prevent"]),class:"fa-solid fa-circle-minus ml-2"},null,8,we),e("i",{onClick:B(k=>ue(l),["prevent"]),class:"fa-solid fa-trash"},null,8,xe)])]),e("input",{class:ne("btn"+A+1),onClick:k=>X(l,x.value),type:"submit",value:"\u9001\u51FA\u8CFC\u7269\u8ECA"},null,10,Me)]))),128))]),e("p",Te,[C("\u7E3D\u8A08:"),$e,C(),e("span",null,c(U(v)),1)]),e("div",Se,[Ne,o(t,{style:{display:"none"}},{default:i(()=>[o(d,{name:"orderKey",modelValue:g.value,"onUpdate:modelValue":u[0]||(u[0]=l=>g.value=l),type:"text"},null,8,["modelValue"])]),_:1}),o(t,{style:{display:"none"}},{default:i(()=>[o(d,{name:"NumberDate",modelValue:p.value,"onUpdate:modelValue":u[1]||(u[1]=l=>p.value=l),type:"text"},null,8,["modelValue"])]),_:1}),o(t,{label:"\u59D3\u540D",prop:"name"},{default:i(()=>[o(d,{name:"form_name",modelValue:n.value.name,"onUpdate:modelValue":u[2]||(u[2]=l=>n.value.name=l),placeholder:"\u8ACB\u8F38\u5165\u4F60\u7684email",type:"test"},null,8,["modelValue"])]),_:1}),o(t,{label:"email",prop:"email"},{default:i(()=>[o(d,{name:"form_email",modelValue:n.value.email,"onUpdate:modelValue":u[3]||(u[3]=l=>n.value.email=l),placeholder:"\u8ACB\u8F38\u5165\u4F60\u7684email",type:"email"},null,8,["modelValue"])]),_:1}),o(t,{label:"\u884C\u52D5\u96FB\u8A71",prop:"phone"},{default:i(()=>[o(d,{name:"form_phone",modelValue:n.value.phone,"onUpdate:modelValue":u[4]||(u[4]=l=>n.value.phone=l),placeholder:"\u8ACB\u8F38\u5165\u4F60\u7684\u884C\u52D5\u96FB\u8A71",type:"text"},null,8,["modelValue"])]),_:1}),o(t,{label:"\u7528\u9910\u65B9\u5F0F",prop:"status"},{default:i(()=>[o(M,{name:"form_status",modelValue:n.value.status,"onUpdate:modelValue":u[5]||(u[5]=l=>n.value.status=l)},{default:i(()=>[o(m,{label:"\u5167\u7528\u8A02\u4F4D",value:"\u5167\u7528\u8A02\u4F4D"}),o(m,{label:"\u81EA\u53D6",value:"\u81EA\u53D6"})]),_:1},8,["modelValue"])]),_:1}),$(o(t,{label:"\u7528\u9910\u6642\u9593",required:""},{default:i(()=>[e("div",qe,c(n.value.time),1),o(V,{name:"form_time",modelValue:n.value.time,"onUpdate:modelValue":u[6]||(u[6]=l=>n.value.time=l),type:"datetime",placeholder:"\u5167\u7528\u8A02\u4F4D",format:"YYYY/MM/DD hh:mm:ss","value-format":"YYYY-MM-DD h:m:s a"},null,8,["modelValue"])]),_:1},512),[[S,n.value.status==="\u5167\u7528\u8A02\u4F4D"]]),o(t,{style:{display:"none"}},{default:i(()=>[o(d,{name:"AllTotal",modelValue:U(v),"onUpdate:modelValue":u[7]||(u[7]=l=>re(v)?v.value=l:null),value:U(v),type:"text"},null,8,["modelValue","value"])]),_:1})])])]),_:1},8,["onSubmit","model","rules"])])],512),[[S,w.value]]),o(le,{class:"addmodal",modelValue:h.value,"onUpdate:modelValue":u[10]||(u[10]=l=>h.value=l),title:"\u8A02\u55AE\u8CC7\u8A0A",center:""},{footer:i(()=>[e("span",Pe,[o(T,{onClick:u[8]||(u[8]=l=>h.value=!1)},{default:i(()=>[C("\u95DC\u9589\u8996\u7A97")]),_:1}),o(T,{type:"primary",onClick:u[9]||(u[9]=l=>h.value=!1)},{default:i(()=>[C(" \u8A02\u55AE\u5B8C\u6210 ")]),_:1})])]),default:i(()=>[e("div",He,[e("div",null,[e("b",null,c(n.value.name)+" \u5148\u751F / \u5C0F\u59D0\uFF0C\u60A8\u597D\uFF1A",1)]),Oe,e("div",ze,[e("b",null,c(p.value),1)]),Ke])]),_:1},8,["modelValue"])])}}});export{Xe as default};
