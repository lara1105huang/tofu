import{d as Q,r as o,a as W,c as I,o as R,b as v,e as a,F as D,f as C,g as l,h as d,i as X,j as p,k as c,t as f,w as Z,v as j,l as V}from"./index.d409c329.js";import{a as G,e as L}from"./index.1e2e6164.js";import{h as J}from"./moment.9709ab41.js";const K={class:"tofu-area"},ee={class:"menu"},ue=["onClick"],le=a("span",null,"\u5143",-1),ae=a("i",{class:"fa-solid fa-circle-plus"},null,-1),oe={class:"demonstration"},te=a("input",{type:"submit",value:"send"},null,-1),ne={class:"el-dialog__body"},se=a("div",{class:"m5"},"\u8A02\u55AE\u7DE8\u865F\uFF1A",-1),re={class:"m5"},me=a("div",null,"\u8ACB\u60A8\u5728\u9810\u5B9A\u6642\u9593\u5167\u5B8C\u6210\u8A02\u55AE\u4EA4\u6613\uFF01\u611F\u8B1D\u60A8\u7684\u5408\u4F5C\uFF01",-1),de={class:"dialog-footer"},_e=Q({__name:"MailTest",setup(ie){const F=o(!1),h=o(),B=o(""),y=o(""),k=o(""),E=o(""),Y=o(""),U=o();o(),o(),o(),o();const n=o({name:"",email:"",phone:"",date:"",time:"",status:""}),M=W({name:[{required:!0,message:"\u8ACB\u8F38\u5165\u540D\u5B57",trigger:"blur"}],email:[{required:!0,message:"\u8ACB\u8F38\u5165\u4FE1\u7BB1",trigger:"blur"}],phone:[{required:!0,message:"\u8ACB\u8F38\u5165\u884C\u52D5\u96FB\u8A71",trigger:"blur"}]}),A=o(J(new Date).format("YYYY-MM-DD-HHmmssSSS")),w=t=>{try{const e={NumberDate:A,formName:B,form_email:y,form_phone:k,form_status:E,form_time:Y,cartItemName:U,countAllTotal:T};L.sendForm("service_v77i5ep","template_6m442te",t.target,"aQibbyOFShdl2H3vj",e)}catch(e){console.log({error:e})}},r=o([]),x=o(!1),N=o(),S=t=>{console.log("\u65B0\u589E\u8CFC\u7269\u8ECA\u7269\u4EF6",t);var e=[];e[0]=t[0],console.log("\u6293\u5546\u54C1id",e[0]),N.value=e[0],e[1]=t[1],e[2]=t[2];var m=1;for(var s in r.value)if(r.value[s][1]===t[1]){m=r.value[s][3]+1;var i=r.value.indexOf(r.value[s]);r.value.splice(i,1)}e[3]=m,e[4]=t[2]*t[3],r.value.push(e),r.value.length>0&&(x.value=!0)},T=I(()=>{var t=0;for(var e in r.value)t+=r.value[e][3]*r.value[e][2];return t}),g=o(),q=async()=>{const t="https://sheets.googleapis.com/v4/spreadsheets/19YWnM9PrXXEUOcT9zWkQYpiZ1W3o6i-UToEGsUPcFcU/values/\u5546\u54C1\u5217\u8868?alt=json&key=AIzaSyAieT4Folrx3Tsx-iZqzu_HyNBt349BMaw";await G.get(t).then(e=>{g.value=e.data.values;for(var m=0;m<=g.value.length;m++)for(var s=g.value[0],i=0;i<=s.length;i++)s[i]})};return R(()=>{q()}),(t,e)=>{const m=p("el-input"),s=p("el-form-item"),i=p("el-radio"),$=p("el-radio-group"),H=p("el-date-picker"),P=p("el-form"),b=p("el-button"),z=p("el-dialog");return c(),v("div",K,[a("ul",ee,[(c(!0),v(D,null,C(g.value,u=>(c(),v("li",{key:u},[a("a",{onClick:_=>S(u)},[(c(!0),v(D,null,C(u,_=>(c(),v("div",{key:_},[a("span",null,f(_),1)]))),128)),le,ae],8,ue)]))),128))]),l(P,{onSubmit:X(w,["prevent"]),ref_key:"ruleFormRef",ref:h,model:n.value,rules:M,"label-width":"120px",class:"demo-ruleForm","status-icon":""},{default:d(()=>[l(s,{style:{display:"none"}},{default:d(()=>[l(m,{name:"NumberDate",modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=u=>A.value=u),type:"text"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u59D3\u540D",prop:"name"},{default:d(()=>[l(m,{name:"formName",modelValue:n.value.name,"onUpdate:modelValue":e[1]||(e[1]=u=>n.value.name=u)},null,8,["modelValue"])]),_:1}),l(s,{label:"\u96FB\u5B50\u4FE1\u7BB1",prop:"email"},{default:d(()=>[l(m,{name:"form_email",modelValue:n.value.email,"onUpdate:modelValue":e[2]||(e[2]=u=>n.value.email=u)},null,8,["modelValue"])]),_:1}),l(s,{label:"\u884C\u52D5\u96FB\u8A71",prop:"phone"},{default:d(()=>[l(m,{name:"form_phone",modelValue:n.value.phone,"onUpdate:modelValue":e[3]||(e[3]=u=>n.value.phone=u)},null,8,["modelValue"])]),_:1}),l(s,{label:"\u7528\u9910\u65B9\u5F0F",prop:"status"},{default:d(()=>[l($,{name:"form_status",modelValue:n.value.status,"onUpdate:modelValue":e[4]||(e[4]=u=>n.value.status=u)},{default:d(()=>[l(i,{label:"\u5167\u7528\u8A02\u4F4D",value:"\u5167\u7528\u8A02\u4F4D"}),l(i,{label:"\u81EA\u53D6",value:"\u81EA\u53D6"})]),_:1},8,["modelValue"])]),_:1}),Z(l(s,{label:"\u7528\u9910\u6642\u9593",required:""},{default:d(()=>[a("div",oe,f(n.value.time),1),l(H,{name:"form_time",modelValue:n.value.time,"onUpdate:modelValue":e[5]||(e[5]=u=>n.value.time=u),type:"datetime",placeholder:"Pick a Date",format:"YYYY/MM/DD hh:mm:ss","value-format":"YYYY-MM-DD h:m:s a"},null,8,["modelValue"])]),_:1},512),[[j,n.value.status==="\u5167\u7528\u8A02\u4F4D"]]),a("table",null,[a("tbody",null,[(c(!0),v(D,null,C(r.value,(u,_)=>(c(),v("tr",{key:_},[V(f(u)+" ",1),a("td",null,[l(m,{name:"cartItemName",modelValue:u[1],"onUpdate:modelValue":O=>u[1]=O,value:u[1]},null,8,["modelValue","onUpdate:modelValue","value"])]),a("td",null,[l(m,{name:"countAllTotal"})])]))),128))])]),te]),_:1},8,["onSubmit","model","rules"]),l(z,{class:"addmodal",modelValue:F.value,"onUpdate:modelValue":e[8]||(e[8]=u=>F.value=u),title:"\u8A02\u55AE\u8CC7\u8A0A",center:""},{footer:d(()=>[a("span",de,[l(b,{onClick:e[6]||(e[6]=u=>F.value=!1)},{default:d(()=>[V("\u95DC\u9589\u8996\u7A97")]),_:1}),l(b,{type:"primary",onClick:e[7]||(e[7]=u=>F.value=!1)},{default:d(()=>[V(" \u8A02\u55AE\u5B8C\u6210 ")]),_:1})])]),default:d(()=>[a("div",ne,[a("div",null,[a("b",null,f(n.value.name)+" \u5148\u751F / \u5C0F\u59D0\uFF0C\u60A8\u597D\uFF1A",1)]),se,a("div",re,[a("b",null,f(A.value),1)]),me])]),_:1},8,["modelValue"])])}}});export{_e as default};
