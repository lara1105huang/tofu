import{d as le,r as o,a as ae,c as oe,o as se,b as p,e,F as y,f as V,w as M,v as x,g as s,h as d,i as g,j as _,k as f,t as c,l as C,n as te,u as k,m as ne}from"./index.4ad4940a.js";import{a as re,e as ie}from"./index.1e2e6164.js";import{h as T}from"./moment.9709ab41.js";import{f as B}from"./firebaseConfig.615b9655.js";const de={class:"tofu-area"},me={class:"menu"},ce=["onClick"],ve=e("span",null,"\u5143",-1),_e=e("i",{class:"fa-solid fa-circle-plus"},null,-1),pe=e("div",{class:"cart_sun"},[e("h4",null,"\u81EA\u53D6\u8CFC\u7269\u8ECA"),e("p",null,"\u8ACB\u65BC\u8A02\u99101\u5C0F\u6642\u4E4B\u5167\u4F86\u96FB\u9818\u53D6\u8CFC\u7269\u9805\u76EE\uFF0C\u8B1D\u8B1D\u60A8\u7684\u5408\u4F5C\uFF01"),e("p",null,"\u672C\u5E97\u63A1\u73FE\u91D1\u4EA4\u6613\uFF01")],-1),fe={class:"menu_shop"},Fe=e("div",{class:"order_content_headline"},"\u8A02\u8CFC\u5167\u5BB9\uFF1A",-1),Ae={class:"form-area"},Ce={class:"cartAll"},he={class:"cart-item"},De={class:"cart-title"},ge={class:"price"},Be=e("span",{class:"money-icon"},"$",-1),be=e("span",{class:"mount-icon"},"x",-1),ye={class:"count"},Ve={class:"sum"},ke=e("span",{class:"money-icon"},"$",-1),Ee={class:"handler"},Ye=["onClick"],we=["onClick"],Ue=["onClick"],Me=["onClick"],xe={class:"countAllTotal"},Te=e("span",{class:"mount-icon"},"$",-1),$e={class:"order_info"},Se=e("div",{class:"headline"},"\u8A02\u8CFC\u4EBA\u8CC7\u6599\uFF1A",-1),Ne={class:"demonstration"},qe={class:"el-dialog__body"},He=e("div",{class:"m5"},"\u8A02\u55AE\u7DE8\u865F\uFF1A",-1),Oe={class:"m5"},ze=e("div",null,"\u8ACB\u60A8\u5728\u9810\u5B9A\u6642\u9593\u5167\u5B8C\u6210\u8A02\u55AE\u4EA4\u6613\uFF01\u611F\u8B1D\u60A8\u7684\u5408\u4F5C\uFF01",-1),Pe={class:"dialog-footer"},Xe=le({__name:"Home",setup(Qe){const $=o(""),S=o(""),N=o(""),q=o(""),H=o("");o();const h=o(!1),D=o(),E=o(!1),r=o([]),F=o(T(new Date).format("YYYY-MM-DD-HHmmssSSS")),t=o({name:"",email:"",phone:"",status:"",time:""}),Y=o(),O=ae({name:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684\u59D3\u540D",trigger:"blur"}],email:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684email",trigger:"blur"}],phone:[{required:!0,message:"\u8ACB\u8F38\u5165\u60A8\u7684\u884C\u52D5\u96FB\u8A71",trigger:"blur"},{min:10,max:10,message:"\u884C\u52D5\u96FB\u8A71\u865F\u78BC\u70BA10\u78BC\uFF01",trigger:"blur"}],status:[{required:!0,message:"\u8ACB\u9078\u64C7\u4F60\u7684\u98DF\u7528\u65B9\u5F0F\uFF01",trigger:"change"}]});var z=B.database().ref("orders/");const P=o({}),Q=()=>{z.once("value",a=>{P.value=a.val()})};o({id:"",productName:"",price:"",count:"",total:""}),o();const R=a=>{try{const u={NumberDate:F,form_name:$,form_email:S,form_phone:N,form_time:H,form_status:q,AllTotal:v};console.log(u),ie.sendForm("service_v77i5ep","template_jqd9wwu",a.target,"aQibbyOFShdl2H3vj",u)}catch(u){console.log({error:u})}};o();const W=()=>{h.value=!0},j=async(a,u)=>{if(!!u){var i=B.database().ref("user/"),n=B.database().ref("orders/");B.database().ref("orders/list/"),await u.validate((m,w)=>{m&&(i.push({orderUser:t.value}),n.push({orderNo:F.value,orderUser:t.value,time:T(new Date).format("YYYY-MM-DD HH:mm"),countTotal:v.value,list:r.value}),W(F.value,t.value,v.value))})}},L=async()=>{const a="https://sheets.googleapis.com/v4/spreadsheets/19YWnM9PrXXEUOcT9zWkQYpiZ1W3o6i-UToEGsUPcFcU/values/\u5546\u54C1\u5217\u8868?alt=json&key=AIzaSyAieT4Folrx3Tsx-iZqzu_HyNBt349BMaw";await re.get(a).then(u=>{D.value=u.data.values;for(var i=0;i<=D.value.length;i++)for(var n=D.value[0],m=0;m<=n.length;m++)n[m]})},X=o(),Z=a=>{var u=[];u[0]=a[0],X.value=u[0],u[1]=a[1],u[2]=a[2];var i=1;for(var n in r.value)if(r.value[n][1]===a[1]){i=r.value[n][3]+1;var m=r.value.indexOf(r.value[n]);r.value.splice(m,1)}u[3]=i,r.value.push(u),r.value.length>0&&(E.value=!0)};o();const G=a=>{a[3]++};o([]);const J=a=>{console.log("\u6E1B\u5C11\u6578\u91CF",a),a[3]--,a[3]<=0&&r.value.splice(a,1)},K=a=>{r.value.splice(a,1)},v=oe(()=>{var a=0;for(var u in r.value)a+=r.value[u][3]*r.value[u][2];return a});return se(()=>{L(),Q()}),(a,u)=>{const i=_("el-input"),n=_("el-form-item"),m=_("el-radio"),w=_("el-radio-group"),I=_("el-date-picker"),ee=_("el-form"),U=_("el-button"),ue=_("el-dialog");return f(),p("div",de,[e("ul",me,[(f(!0),p(y,null,V(D.value,l=>(f(),p("li",{key:l},[e("a",{onClick:A=>Z(l)},[(f(!0),p(y,null,V(l,A=>(f(),p("div",{key:A},[e("span",null,c(A),1)]))),128)),ve,_e],8,ce)]))),128))]),M(e("div",null,[pe,e("div",fe,[s(ee,{ref_key:"ruleFormRef",ref:Y,onSubmit:g(R,["prevent"]),model:t.value,rules:O,"status-icon":""},{default:d(()=>[Fe,e("div",Ae,[e("div",Ce,[(f(!0),p(y,null,V(r.value,(l,A)=>(f(),p("div",{class:"cart",key:A},[e("div",he,[e("div",De,c(l[1]),1),e("div",null,[e("span",ge,[Be,C(c(l[2]),1)]),be,e("span",ye,c(l[3]),1),e("span",Ve,[ke,C(c(l[2]*l[3]),1)])]),e("div",Ee,[e("i",{onClick:g(b=>G(l),["prevent"]),class:"fa-solid fa-circle-plus"},null,8,Ye),e("i",{onClick:g(b=>J(l),["prevent"]),class:"fa-solid fa-circle-minus ml-2"},null,8,we),e("i",{onClick:g(b=>K(l),["prevent"]),class:"fa-solid fa-trash"},null,8,Ue)])]),e("input",{class:te("btn"+A+1),onClick:b=>j(l,Y.value),type:"submit",value:"\u9001\u51FA\u8CFC\u7269\u8ECA"},null,10,Me)]))),128))]),e("p",xe,[C("\u7E3D\u8A08:"),Te,C(),e("span",null,c(k(v)),1)]),e("div",$e,[Se,s(n,{style:{display:"none"}},{default:d(()=>[s(i,{name:"NumberDate",modelValue:F.value,"onUpdate:modelValue":u[0]||(u[0]=l=>F.value=l),type:"text"},null,8,["modelValue"])]),_:1}),s(n,{label:"\u59D3\u540D",prop:"name"},{default:d(()=>[s(i,{name:"form_name",modelValue:t.value.name,"onUpdate:modelValue":u[1]||(u[1]=l=>t.value.name=l),placeholder:"\u8ACB\u8F38\u5165\u4F60\u7684\u59D3\u540D",type:"test"},null,8,["modelValue"])]),_:1}),s(n,{label:"email",prop:"email"},{default:d(()=>[s(i,{name:"form_email",modelValue:t.value.email,"onUpdate:modelValue":u[2]||(u[2]=l=>t.value.email=l),placeholder:"\u8ACB\u8F38\u5165\u4F60\u7684email",type:"email"},null,8,["modelValue"])]),_:1}),s(n,{label:"\u884C\u52D5\u96FB\u8A71",prop:"phone"},{default:d(()=>[s(i,{name:"form_phone",modelValue:t.value.phone,"onUpdate:modelValue":u[3]||(u[3]=l=>t.value.phone=l),placeholder:"\u8ACB\u8F38\u5165\u4F60\u7684\u884C\u52D5\u96FB\u8A71",type:"text"},null,8,["modelValue"])]),_:1}),s(n,{label:"\u7528\u9910\u65B9\u5F0F",prop:"status"},{default:d(()=>[s(w,{name:"form_status",modelValue:t.value.status,"onUpdate:modelValue":u[4]||(u[4]=l=>t.value.status=l)},{default:d(()=>[s(m,{label:"\u5167\u7528\u8A02\u4F4D",value:"\u5167\u7528\u8A02\u4F4D"}),s(m,{label:"\u81EA\u53D6",value:"\u81EA\u53D6"})]),_:1},8,["modelValue"])]),_:1}),M(s(n,{label:"\u7528\u9910\u6642\u9593",required:""},{default:d(()=>[e("div",Ne,c(t.value.time),1),s(I,{name:"form_time",modelValue:t.value.time,"onUpdate:modelValue":u[5]||(u[5]=l=>t.value.time=l),type:"datetime",placeholder:"\u5167\u7528\u8A02\u4F4D",format:"YYYY/MM/DD hh:mm:ss","value-format":"YYYY-MM-DD h:m:s a"},null,8,["modelValue"])]),_:1},512),[[x,t.value.status==="\u5167\u7528\u8A02\u4F4D"]]),s(n,{style:{display:"none"}},{default:d(()=>[s(i,{name:"AllTotal",modelValue:k(v),"onUpdate:modelValue":u[6]||(u[6]=l=>ne(v)?v.value=l:null),value:k(v),type:"text"},null,8,["modelValue","value"])]),_:1})])])]),_:1},8,["onSubmit","model","rules"])])],512),[[x,E.value]]),s(ue,{class:"addmodal",modelValue:h.value,"onUpdate:modelValue":u[9]||(u[9]=l=>h.value=l),title:"\u8A02\u55AE\u8CC7\u8A0A",center:""},{footer:d(()=>[e("span",Pe,[s(U,{onClick:u[7]||(u[7]=l=>h.value=!1)},{default:d(()=>[C("\u95DC\u9589\u8996\u7A97")]),_:1}),s(U,{type:"primary",onClick:u[8]||(u[8]=l=>h.value=!1)},{default:d(()=>[C(" \u8A02\u55AE\u5B8C\u6210 ")]),_:1})])]),default:d(()=>[e("div",qe,[e("div",null,[e("b",null,c(t.value.name)+" \u5148\u751F / \u5C0F\u59D0\uFF0C\u60A8\u597D\uFF1A",1)]),He,e("div",Oe,[e("b",null,c(F.value),1)]),ze])]),_:1},8,["modelValue"])])}}});export{Xe as default};
